// // 1. Put data_wak_unpack.bat in your Noita root directory, it's pobably is C:\Program Files (x86)\Steam\steamapps\common\Noita
// // 2. Run that file -- you will get a new folder with the game files unpacked
// // 3. Run this script: node wandmaker.js

var fs = require('fs');
var os = require('os');
var path = require('path');

// Paste file contents inside brackets into the wandSprites.js file
var outputFile = path.join(__dirname, 'data', 'wands.txt');

// Clean output file contents
fs.writeFile(outputFile, '', function(){console.log('done')});

// Set two starter wands' path, and common wands path
var wandsBasePath = path.join(process.env.USERPROFILE, 'AppData', 'LocalLow','Nolla_Games_Noita', 'data', 'items_gfx');
var wandsPath = path.join(wandsBasePath, 'wands');
var starterWandHandgunPath = path.join(wandsBasePath, 'bomb_wand.png');
var starterWandBombWandPath = path.join(wandsBasePath, 'handgun.png');

// Common wands
var wandNames = [ "wand_0000", "wand_0001", "wand_0002", "wand_0003", "wand_0004", "wand_0005", "wand_0006", "wand_0007", "wand_0008", "wand_0009", "wand_0010", "wand_0011", "wand_0012", "wand_0013", "wand_0014", "wand_0015", "wand_0016", "wand_0017", "wand_0018", "wand_0019", "wand_0020", "wand_0021", "wand_0022", "wand_0023", "wand_0024", "wand_0025", "wand_0026", "wand_0027", "wand_0028", "wand_0029", "wand_0030", "wand_0031", "wand_0032", "wand_0033", "wand_0034", "wand_0035", "wand_0036", "wand_0037", "wand_0038", "wand_0039", "wand_0040", "wand_0041", "wand_0042", "wand_0043", "wand_0044", "wand_0045", "wand_0046", "wand_0047", "wand_0048", "wand_0049", "wand_0050", "wand_0051", "wand_0052", "wand_0053", "wand_0054", "wand_0055", "wand_0056", "wand_0057", "wand_0058", "wand_0059", "wand_0060", "wand_0061", "wand_0062", "wand_0063", "wand_0064", "wand_0065", "wand_0066", "wand_0067", "wand_0068", "wand_0069", "wand_0070", "wand_0071", "wand_0072", "wand_0073", "wand_0074", "wand_0075", "wand_0076", "wand_0077", "wand_0078", "wand_0079", "wand_0080", "wand_0081", "wand_0082", "wand_0083", "wand_0084", "wand_0085", "wand_0086", "wand_0087", "wand_0088", "wand_0089", "wand_0090", "wand_0091", "wand_0092", "wand_0093", "wand_0094", "wand_0095", "wand_0096", "wand_0097", "wand_0098", "wand_0099", "wand_0100", "wand_0101", "wand_0102", "wand_0103", "wand_0104", "wand_0105", "wand_0106", "wand_0107", "wand_0108", "wand_0109", "wand_0110", "wand_0111", "wand_0112", "wand_0113", "wand_0114", "wand_0115", "wand_0116", "wand_0117", "wand_0118", "wand_0119", "wand_0120", "wand_0121", "wand_0122", "wand_0123", "wand_0124", "wand_0125", "wand_0126", "wand_0127", "wand_0128", "wand_0129", "wand_0130", "wand_0131", "wand_0132", "wand_0133", "wand_0134", "wand_0135", "wand_0136", "wand_0137", "wand_0138", "wand_0139", "wand_0140", "wand_0141", "wand_0142", "wand_0143", "wand_0144", "wand_0145", "wand_0146", "wand_0147", "wand_0148", "wand_0149", "wand_0150", "wand_0151", "wand_0152", "wand_0153", "wand_0154", "wand_0155", "wand_0156", "wand_0157", "wand_0158", "wand_0159", "wand_0160", "wand_0161", "wand_0162", "wand_0163", "wand_0164", "wand_0165", "wand_0166", "wand_0167", "wand_0168", "wand_0169", "wand_0170", "wand_0171", "wand_0172", "wand_0173", "wand_0174", "wand_0175", "wand_0176", "wand_0177", "wand_0178", "wand_0179", "wand_0180", "wand_0181", "wand_0182", "wand_0183", "wand_0184", "wand_0185", "wand_0186", "wand_0187", "wand_0188", "wand_0189", "wand_0190", "wand_0191", "wand_0192", "wand_0193", "wand_0194", "wand_0195", "wand_0196", "wand_0197", "wand_0198", "wand_0199", "wand_0200", "wand_0201", "wand_0202", "wand_0203", "wand_0204", "wand_0205", "wand_0206", "wand_0207", "wand_0208", "wand_0209", "wand_0210", "wand_0211", "wand_0212", "wand_0213", "wand_0214", "wand_0215", "wand_0216", "wand_0217", "wand_0218", "wand_0219", "wand_0220", "wand_0221", "wand_0222", "wand_0223", "wand_0224", "wand_0225", "wand_0226", "wand_0227", "wand_0228", "wand_0229", "wand_0230", "wand_0231", "wand_0232", "wand_0233", "wand_0234", "wand_0235", "wand_0236", "wand_0237", "wand_0238", "wand_0239", "wand_0240", "wand_0241", "wand_0242", "wand_0243", "wand_0244", "wand_0245", "wand_0246", "wand_0247", "wand_0248", "wand_0249", "wand_0250", "wand_0251", "wand_0252", "wand_0253", "wand_0254", "wand_0255", "wand_0256", "wand_0257", "wand_0258", "wand_0259", "wand_0260", "wand_0261", "wand_0262", "wand_0263", "wand_0264", "wand_0265", "wand_0266", "wand_0267", "wand_0268", "wand_0269", "wand_0270", "wand_0271", "wand_0272", "wand_0273", "wand_0274", "wand_0275", "wand_0276", "wand_0277", "wand_0278", "wand_0279", "wand_0280", "wand_0281", "wand_0282", "wand_0283", "wand_0284", "wand_0285", "wand_0286", "wand_0287", "wand_0288", "wand_0289", "wand_0290", "wand_0291", "wand_0292", "wand_0293", "wand_0294", "wand_0295", "wand_0296", "wand_0297", "wand_0298", "wand_0299", "wand_0300", "wand_0301", "wand_0302", "wand_0303", "wand_0304", "wand_0305", "wand_0306", "wand_0307", "wand_0308", "wand_0309", "wand_0310", "wand_0311", "wand_0312", "wand_0313", "wand_0314", "wand_0315", "wand_0316", "wand_0317", "wand_0318", "wand_0319", "wand_0320", "wand_0321", "wand_0322", "wand_0323", "wand_0324", "wand_0325", "wand_0326", "wand_0327", "wand_0328", "wand_0329", "wand_0330", "wand_0331", "wand_0332", "wand_0333", "wand_0334", "wand_0335", "wand_0336", "wand_0337", "wand_0338", "wand_0339", "wand_0340", "wand_0341", "wand_0342", "wand_0343", "wand_0344", "wand_0345", "wand_0346", "wand_0347", "wand_0348", "wand_0349", "wand_0350", "wand_0351", "wand_0352", "wand_0353", "wand_0354", "wand_0355", "wand_0356", "wand_0357", "wand_0358", "wand_0359", "wand_0360", "wand_0361", "wand_0362", "wand_0363", "wand_0364", "wand_0365", "wand_0366", "wand_0367", "wand_0368", "wand_0369", "wand_0370", "wand_0371", "wand_0372", "wand_0373", "wand_0374", "wand_0375", "wand_0376", "wand_0377", "wand_0378", "wand_0379", "wand_0380", "wand_0381", "wand_0382", "wand_0383", "wand_0384", "wand_0385", "wand_0386", "wand_0387", "wand_0388", "wand_0389", "wand_0390", "wand_0391", "wand_0392", "wand_0393", "wand_0394", "wand_0395", "wand_0396", "wand_0397", "wand_0398", "wand_0399", "wand_0400", "wand_0401", "wand_0402", "wand_0403", "wand_0404", "wand_0405", "wand_0406", "wand_0407", "wand_0408", "wand_0409", "wand_0410", "wand_0411", "wand_0412", "wand_0413", "wand_0414", "wand_0415", "wand_0416", "wand_0417", "wand_0418", "wand_0419", "wand_0420", "wand_0421", "wand_0422", "wand_0423", "wand_0424", "wand_0425", "wand_0426", "wand_0427", "wand_0428", "wand_0429", "wand_0430", "wand_0431", "wand_0432", "wand_0433", "wand_0434", "wand_0435", "wand_0436", "wand_0437", "wand_0438", "wand_0439", "wand_0440", "wand_0441", "wand_0442", "wand_0443", "wand_0444", "wand_0445", "wand_0446", "wand_0447", "wand_0448", "wand_0449", "wand_0450", "wand_0451", "wand_0452", "wand_0453", "wand_0454", "wand_0455", "wand_0456", "wand_0457", "wand_0458", "wand_0459", "wand_0460", "wand_0461", "wand_0462", "wand_0463", "wand_0464", "wand_0465", "wand_0466", "wand_0467", "wand_0468", "wand_0469", "wand_0470", "wand_0471", "wand_0472", "wand_0473", "wand_0474", "wand_0475", "wand_0476", "wand_0477", "wand_0478", "wand_0479", "wand_0480", "wand_0481", "wand_0482", "wand_0483", "wand_0484", "wand_0485", "wand_0486", "wand_0487", "wand_0488", "wand_0489", "wand_0490", "wand_0491", "wand_0492", "wand_0493", "wand_0494", "wand_0495", "wand_0496", "wand_0497", "wand_0498", "wand_0499", "wand_0500", "wand_0501", "wand_0502", "wand_0503", "wand_0504", "wand_0505", "wand_0506", "wand_0507", "wand_0508", "wand_0509", "wand_0510", "wand_0511", "wand_0512", "wand_0513", "wand_0514", "wand_0515", "wand_0516", "wand_0517", "wand_0518", "wand_0519", "wand_0520", "wand_0521", "wand_0522", "wand_0523", "wand_0524", "wand_0525", "wand_0526", "wand_0527", "wand_0528", "wand_0529", "wand_0530", "wand_0531", "wand_0532", "wand_0533", "wand_0534", "wand_0535", "wand_0536", "wand_0537", "wand_0538", "wand_0539", "wand_0540", "wand_0541", "wand_0542", "wand_0543", "wand_0544", "wand_0545", "wand_0546", "wand_0547", "wand_0548", "wand_0549", "wand_0550", "wand_0551", "wand_0552", "wand_0553", "wand_0554", "wand_0555", "wand_0556", "wand_0557", "wand_0558", "wand_0559", "wand_0560", "wand_0561", "wand_0562", "wand_0563", "wand_0564", "wand_0565", "wand_0566", "wand_0567", "wand_0568", "wand_0569", "wand_0570", "wand_0571", "wand_0572", "wand_0573", "wand_0574", "wand_0575", "wand_0576", "wand_0577", "wand_0578", "wand_0579", "wand_0580", "wand_0581", "wand_0582", "wand_0583", "wand_0584", "wand_0585", "wand_0586", "wand_0587", "wand_0588", "wand_0589", "wand_0590", "wand_0591", "wand_0592", "wand_0593", "wand_0594", "wand_0595", "wand_0596", "wand_0597", "wand_0598", "wand_0599", "wand_0600", "wand_0601", "wand_0602", "wand_0603", "wand_0604", "wand_0605", "wand_0606", "wand_0607", "wand_0608", "wand_0609", "wand_0610", "wand_0611", "wand_0612", "wand_0613", "wand_0614", "wand_0615", "wand_0616", "wand_0617", "wand_0618", "wand_0619", "wand_0620", "wand_0621", "wand_0622", "wand_0623", "wand_0624", "wand_0625", "wand_0626", "wand_0627", "wand_0628", "wand_0629", "wand_0630", "wand_0631", "wand_0632", "wand_0633", "wand_0634", "wand_0635", "wand_0636", "wand_0637", "wand_0638", "wand_0639", "wand_0640", "wand_0641", "wand_0642", "wand_0643", "wand_0644", "wand_0645", "wand_0646", "wand_0647", "wand_0648", "wand_0649", "wand_0650", "wand_0651", "wand_0652", "wand_0653", "wand_0654", "wand_0655", "wand_0656", "wand_0657", "wand_0658", "wand_0659", "wand_0660", "wand_0661", "wand_0662", "wand_0663", "wand_0664", "wand_0665", "wand_0666", "wand_0667", "wand_0668", "wand_0669", "wand_0670", "wand_0671", "wand_0672", "wand_0673", "wand_0674", "wand_0675", "wand_0676", "wand_0677", "wand_0678", "wand_0679", "wand_0680", "wand_0681", "wand_0682", "wand_0683", "wand_0684", "wand_0685", "wand_0686", "wand_0687", "wand_0688", "wand_0689", "wand_0690", "wand_0691", "wand_0692", "wand_0693", "wand_0694", "wand_0695", "wand_0696", "wand_0697", "wand_0698", "wand_0699", "wand_0700", "wand_0701", "wand_0702", "wand_0703", "wand_0704", "wand_0705", "wand_0706", "wand_0707", "wand_0708", "wand_0709", "wand_0710", "wand_0711", "wand_0712", "wand_0713", "wand_0714", "wand_0715", "wand_0716", "wand_0717", "wand_0718", "wand_0719", "wand_0720", "wand_0721", "wand_0722", "wand_0723", "wand_0724", "wand_0725", "wand_0726", "wand_0727", "wand_0728", "wand_0729", "wand_0730", "wand_0731", "wand_0732", "wand_0733", "wand_0734", "wand_0735", "wand_0736", "wand_0737", "wand_0738", "wand_0739", "wand_0740", "wand_0741", "wand_0742", "wand_0743", "wand_0744", "wand_0745", "wand_0746", "wand_0747", "wand_0748", "wand_0749", "wand_0750", "wand_0751", "wand_0752", "wand_0753", "wand_0754", "wand_0755", "wand_0756", "wand_0757", "wand_0758", "wand_0759", "wand_0760", "wand_0761", "wand_0762", "wand_0763", "wand_0764", "wand_0765", "wand_0766", "wand_0767", "wand_0768", "wand_0769", "wand_0770", "wand_0771", "wand_0772", "wand_0773", "wand_0774", "wand_0775", "wand_0776", "wand_0777", "wand_0778", "wand_0779", "wand_0780", "wand_0781", "wand_0782", "wand_0783", "wand_0784", "wand_0785", "wand_0786", "wand_0787", "wand_0788", "wand_0789", "wand_0790", "wand_0791", "wand_0792", "wand_0793", "wand_0794", "wand_0795", "wand_0796", "wand_0797", "wand_0798", "wand_0799", "wand_0800", "wand_0801", "wand_0802", "wand_0803", "wand_0804", "wand_0805", "wand_0806", "wand_0807", "wand_0808", "wand_0809", "wand_0810", "wand_0811", "wand_0812", "wand_0813", "wand_0814", "wand_0815", "wand_0816", "wand_0817", "wand_0818", "wand_0819", "wand_0820", "wand_0821", "wand_0822", "wand_0823", "wand_0824", "wand_0825", "wand_0826", "wand_0827", "wand_0828", "wand_0829", "wand_0830", "wand_0831", "wand_0832", "wand_0833", "wand_0834", "wand_0835", "wand_0836", "wand_0837", "wand_0838", "wand_0839", "wand_0840", "wand_0841", "wand_0842", "wand_0843", "wand_0844", "wand_0845", "wand_0846", "wand_0847", "wand_0848", "wand_0849", "wand_0850", "wand_0851", "wand_0852", "wand_0853", "wand_0854", "wand_0855", "wand_0856", "wand_0857", "wand_0858", "wand_0859", "wand_0860", "wand_0861", "wand_0862", "wand_0863", "wand_0864", "wand_0865", "wand_0866", "wand_0867", "wand_0868", "wand_0869", "wand_0870", "wand_0871", "wand_0872", "wand_0873", "wand_0874", "wand_0875", "wand_0876", "wand_0877", "wand_0878", "wand_0879", "wand_0880", "wand_0881", "wand_0882", "wand_0883", "wand_0884", "wand_0885", "wand_0886", "wand_0887", "wand_0888", "wand_0889", "wand_0890", "wand_0891", "wand_0892", "wand_0893", "wand_0894", "wand_0895", "wand_0896", "wand_0897", "wand_0898", "wand_0899", "wand_0900", "wand_0901", "wand_0902", "wand_0903", "wand_0904", "wand_0905", "wand_0906", "wand_0907", "wand_0908", "wand_0909", "wand_0910", "wand_0911", "wand_0912", "wand_0913", "wand_0914", "wand_0915", "wand_0916", "wand_0917", "wand_0918", "wand_0919", "wand_0920", "wand_0921", "wand_0922", "wand_0923", "wand_0924", "wand_0925", "wand_0926", "wand_0927", "wand_0928", "wand_0929", "wand_0930", "wand_0931", "wand_0932", "wand_0933", "wand_0934", "wand_0935", "wand_0936", "wand_0937", "wand_0938", "wand_0939", "wand_0940", "wand_0941", "wand_0942", "wand_0943", "wand_0944", "wand_0945", "wand_0946", "wand_0947", "wand_0948", "wand_0949", "wand_0950", "wand_0951", "wand_0952", "wand_0953", "wand_0954", "wand_0955", "wand_0956", "wand_0957", "wand_0958", "wand_0959", "wand_0960", "wand_0961", "wand_0962", "wand_0963", "wand_0964", "wand_0965", "wand_0966", "wand_0967", "wand_0968", "wand_0969", "wand_0970", "wand_0971", "wand_0972", "wand_0973", "wand_0974", "wand_0975", "wand_0976", "wand_0977", "wand_0978", "wand_0979", "wand_0980", "wand_0981", "wand_0982", "wand_0983", "wand_0984", "wand_0985", "wand_0986", "wand_0987", "wand_0988", "wand_0989", "wand_0990", "wand_0991", "wand_0992", "wand_0993", "wand_0994", "wand_0995", "wand_0996", "wand_0997", "wand_0998", "wand_0999", "wand_1000" ]

// function to encode file data to base64 encoded string
function base64_encode(file) {
    // read binary data
    var bitmap = fs.readFileSync(file);
    // convert binary data to base64 encoded string
    return new Buffer(bitmap).toString('base64');
}

// Process starter wands to the file
base64_encode(starterWandBombWandPath);
fs.appendFileSync(outputFile, "bomb_wand:\n    '"+base64_encode(starterWandBombWandPath)+"',\n");

base64_encode(starterWandHandgunPath);
fs.appendFileSync(outputFile, "handgun:\n    '"+base64_encode(starterWandHandgunPath)+"',\n");
console.log("Starter wands added");

for (i = 0; i < wandNames.length; i++) {
    var base64str = base64_encode(wandsPath+"\\"+wandNames[i]+".png");
    fs.appendFileSync(outputFile, wandNames[i]+":\n    '"+base64str+"',\n");
    console.log("Added "+wandNames[i]+"\n");
}